<div class="card card-xxl-stretch mb-5 mb-xl-8">
  <!-- begin::Header -->
  <div class="card-header border-0 pt-5">
    <h3 class="card-title align-items-start flex-column">
      <span class="card-label fw-bolder fs-2 mb-1">{{ workspace_name }}</span>
    </h3>
    <div class="d-flex" style="gap: 8px;">
      <div class="card-toolbar">
        <a routerLink="/workspaces/list" class="btn btn-sm btn-light-primary">
          <i class="fa fa-arrow-left"></i>
          Back
        </a>
      </div>
      <div class="card-toolbar" data-bs-toggle="tooltip" data-bs-placement="top" data-bs-trigger="hover"
        title="Click to create a new workspace">
        <button (click)="newAnalysis()" class="btn btn-sm btn-light-primary">
          <span [inlineSVG]="'./assets/media/icons/duotune/arrows/arr075.svg'" class="svg-icon svg-icon-3"></span>
          New Analysis
        </button>
      </div>
    </div>
  </div>
  <!-- end::Header -->
  <!-- begin::Body -->
  <div class="card-body py-3">

    <div class="form form-label-right mb-5">
      <div class="form-group row" [formGroup]="filterGroup">
        <div class="col-lg-3">
          <input type="text" class="form-control" name="analysisName" placeholder="Search" value=""
            formControlName="analysisName" /><small class="form-text text-muted"><b>Search</b> in Analysis Name</small>
        </div>
        <div class="col-lg-3">
          <input type="text" class="form-control" name="sampleName" placeholder="Search" value=""
            formControlName="sampleName" /><small class="form-text text-muted"><b>Search</b> in Sample Name</small>
        </div>
        <div class="col-lg-3">
          <select class="form-control" placeholder="Filter by Assembly" name="assembly" formControlName="assembly">
            <option value='' [selected]="true">All</option>
            <option value='hg19'>Hg19</option>
            <option value='hg38'>Hg38</option>
          </select><small class="form-text text-muted"><b>Filter</b> by Assembly</small>
        </div>
        <div class="col-lg-3">
          <select class="form-control" placeholder="Filter by Status" name="status" formControlName="status">
            <option value='' [selected]="true">All</option>
            <option value='queuing'>Queuing</option>
            <option value='analyzing'>Analyzing</option>
            <option value='analyzed'>Analyzed</option>
            <option value='error'>Error</option>
          </select><small class="form-text text-muted"><b>Filter</b> by Status</small>
        </div>
      </div>
    </div>

    <ng-container *ngIf="grouping.getSelectedRowsCount()">
      <div class="form">
        <div class="row align-items-center form-group-actions margin-top-20 margin-bottom-20">
          <div class="col-xl-12">
            <div class="form-group form-group-inline">
              <div class="form-label form-label-no-wrap">
                <label class="font-bold font-danger"><span>Selected records count:
                    <b>{{ grouping.getSelectedRowsCount() }}</b></span></label>
              </div>
              <div>
                <button type="button" class="btn btn-danger font-weight-bolder font-size-sm mr-1"
                  (click)="deleteSelected()">
                  <i class="fa fa-trash"></i> Delete All
                </button>
              </div>
            </div>
          </div>
        </div>
      </div>
    </ng-container>

    <app-paginator class="d-flex justify-content-between align-items-center flex-wrap" [paginator]="paginator"
      [isLoading]="isLoading" (paginate)="paginate($event)"></app-paginator>

    <!-- begin::Table container -->
    <div class="table-responsive">
      <!-- begin::Table -->
      <table class="table table-row-dashed table-row-gray-300 align-middle gs-0 gy-4">
        <!-- begin::Table head -->
        <thead>
          <tr class="fw-bolder text-muted">
            <th class="w-25px">
              <div class="
                form-check form-check-sm form-check-custom form-check-solid
              ">
                <input class="form-check-input" type="checkbox" value="1" data-kt-check="true"
                  data-kt-check-target=".widget-9-check" (click)="grouping.selectAllRows()"
                  [checked]="grouping.checkAreAllRowsSelected()" />
              </div>
            </th>
            <th class="min-w-50px">ID</th>
            <th class="min-w-120px">SAMPLE NAME</th>
            <th class="min-w-120px">PIPELINE</th>
            <th class="min-w-120px">CREATED</th>
            <th class="min-w-120px">UPDATED</th>
            <th class="min-w-120px">ANALYZED</th>
            <th class="min-w-120px">VARIANTS</th>
            <th class="min-w-120px">STATUS</th>
            <th class="min-w-50px text-end">ACTIONS</th>
          </tr>
        </thead>
        <!-- end::Table head -->
        <!-- begin::Table body -->
        <tbody *ngFor="let analysis of analyses">
          <tr>
            <td>
              <div class="
                form-check form-check-sm form-check-custom form-check-solid
              ">
                <input class="form-check-input widget-9-check" type="checkbox" value="{{analysis.id}}"
                  (click)="grouping.selectRow(analysis.id)" [checked]="grouping.isRowSelected(analysis.id)" />
              </div>
            </td>
            <td>
              <p class="text-gray-900 fw-bolder d-block fs-6" style="margin-top: revert;">
                {{analysis.id}}
              </p>
            </td>
            <td>
              <div class="d-flex align-items-center">
                <div class="d-flex justify-content-start flex-column">
                  <p 
                    class="text-gray-900 fw-bolder text-hover-primary fs-6">
                    {{analysis.name}}
                  </p>
                </div>
              </div>
            </td>
            <td>
              <p class="text-gray-900 fw-bolder d-block fs-6" style="margin-top: revert;">
                {{analysis.pipeline_name}}
              </p>
            </td>
            <td>
              <p class="text-gray-900 fw-bolder d-block fs-6" style="margin-top: revert;">
                {{analysis.createdAt}}
              </p>
            </td>
            <td>
              <p class="text-gray-900 fw-bolder d-block fs-6" style="margin-top: revert;">
                {{analysis.updatedAt}}
              </p>
            </td>
            <td>
              <p class="text-gray-900 fw-bolder d-block fs-6" style="margin-top: revert;">
                {{analysis.analyzed}}
              </p>
            </td>
            <td>
              <p class="text-gray-900 fw-bolder d-block fs-6" style="margin-top: revert;">
                {{analysis.variants}}
              </p>
            </td>
            <td>
              <span class="badge fs-6" style="margin-top: revert;" [ngClass]="{
                'badge-light-success': analysis.status === 'Analyzed',
                'badge-light-warning': analysis.status === 'VCF Analyzing' || analysis.status === 'FASTQ Analyzing',
                'badge-light-primary': analysis.status === 'VCF Queuing' || analysis.status === 'FASTQ Queuing',
                'badge-light-danger': analysis.status === 'Error'
              }">
                {{ analysis.status }}
              </span>
            </td>
            <td>
              <div class="d-flex justify-content-end flex-shrink-0">
                <a href="#" *ngIf="analysis.status === 'Analyzed'" class="
                btn btn-icon btn-bg-light btn-active-color-primary btn-sm
                me-1
              ">
                  <span [inlineSVG]="'./assets/media/icons/duotune/art/art005.svg'" class="svg-icon svg-icon-3"></span>
                </a>
                <button (click)="delete(analysis.id)" class="
                  btn btn-icon btn-bg-light btn-active-color-primary btn-sm
                ">
                  <span [inlineSVG]="
                    './assets/media/icons/duotune/general/gen027.svg'
                  " class="svg-icon svg-icon-3"></span>
                </button>
              </div>
            </td>
          </tr>
        </tbody>
        <!-- end::Table body -->
      </table>
      <!-- end::Table -->
    </div>
    <!-- end::Table container -->
    <app-paginator class="d-flex justify-content-between align-items-center flex-wrap" [paginator]="paginator"
      [isLoading]="isLoading" (paginate)="paginate($event)"></app-paginator>
  </div>
  <!-- begin::Body -->
</div>